import numpy as np
from collections import defaultdict
from math import ceil


distr_settled_1 = {0: 239, 1: 121, 2: 137, 4: 80, 6: 90, 5: 69, 7: 66, 9: 79, 11: 75, 13: 26, 10: 79, 8: 65, 15: 11,
                   17: 27, 3: 79, 20: 20, 12: 59, 24: 7, 19: 19, 28: 10, 18: 37, 27: 19, 26: 5, 29: 11, 16: 16, 30: 11,
                   14: 24, 25: 14, 21: 9, 23: 4, 22: 4}
distr_settled_2 = {0: 243, 1: 108, 2: 122, 4: 87, 3: 70, 5: 68, 7: 67, 8: 58, 10: 58, 9: 77, 6: 83, 11: 65, 12: 81,
                   13: 19, 20: 25, 17: 17, 14: 33, 22: 11, 21: 9, 19: 28, 15: 31, 18: 28, 16: 24, 29: 6, 28: 12, 24: 5,
                   23: 4, 25: 5, 30: 9, 27: 3, 26: 8}
distr_settled_3 = {0: 231, 1: 108, 2: 95, 3: 80, 4: 115, 5: 68, 7: 59, 6: 78, 8: 74, 9: 79, 11: 66, 10: 69, 17: 20,
                   12: 73, 20: 29, 16: 21, 13: 11, 19: 22, 22: 8, 28: 7, 15: 29, 29: 6, 30: 10, 25: 7, 23: 4, 21: 11,
                   18: 29, 14: 40, 27: 7, 24: 7, 26: 9}
distr_settled_4 = {0: 215, 2: 118, 1: 125, 4: 96, 3: 69, 6: 61, 5: 81, 8: 42, 7: 49, 10: 82, 11: 76, 14: 31, 9: 63,
                   12: 89, 19: 35, 23: 8, 15: 22, 16: 30, 17: 23, 27: 10, 18: 32, 13: 20, 24: 12, 25: 3, 30: 4, 29: 2,
                   22: 15, 21: 6, 26: 8, 28: 7, 20: 22}
distr_settled_5 = {0: 254, 1: 127, 3: 81, 5: 59, 4: 91, 2: 110, 6: 72, 8: 77, 10: 61, 9: 74, 11: 47, 7: 54, 12: 73,
                   13: 12, 17: 23, 20: 25, 30: 9, 24: 13, 29: 12, 14: 35, 15: 28, 16: 30, 18: 43, 19: 23, 21: 12, 27: 4,
                   23: 7, 25: 2, 26: 9, 22: 4, 28: 7}
distr_settled_6 = {0: 242, 1: 117, 2: 112, 3: 85, 4: 58, 6: 58, 8: 57, 5: 70, 7: 73, 13: 13, 9: 73, 16: 34, 12: 86,
                   19: 15, 18: 36, 11: 69, 15: 27, 23: 14, 20: 33, 30: 6, 17: 48, 10: 62, 14: 29, 22: 3, 28: 8, 24: 4,
                   25: 7, 26: 3, 21: 14, 27: 13, 29: 12}
distr_settled_7 = {0: 228, 1: 102, 2: 98, 4: 90, 3: 89, 5: 66, 7: 69, 8: 74, 9: 72, 11: 62, 6: 74, 12: 95, 13: 31,
                   16: 40, 17: 28, 15: 36, 10: 80, 20: 38, 27: 8, 29: 14, 30: 6, 23: 12, 14: 24, 19: 19, 26: 13, 18: 15,
                   28: 7, 25: 6, 22: 6, 24: 6, 21: 6}
list_distr_settled = [distr_settled_1, distr_settled_2, distr_settled_3, distr_settled_4,
                      distr_settled_5, distr_settled_6, distr_settled_7]

# общее количество продаж
distr_settled = defaultdict(int)
for i in list_distr_settled:
    for j in i.keys():
        distr_settled[j] += i[j]
for k in range(31):
    distr_settled[k] /= len(list_distr_settled)

distr_numdays_1 = {0: 191, 1: 100, 2: 110, 4: 61, 6: 64, 5: 53, 7: 50, 9: 54, 11: 46, 13: 18, 10: 56, 8: 49, 15: 9,
                  17: 14, 3: 66, 20: 15, 12: 42, 24: 5, 19: 12, 28: 7, 18: 24, 27: 12, 26: 4, 29: 7, 16: 13, 30: 7,
                  14: 20, 25: 7, 21: 7, 23: 4, 22: 3}
distr_numdays_2 = {0: 206, 1: 92, 2: 99, 4: 68, 3: 54, 5: 52, 7: 43, 8: 43, 10: 44, 9: 48, 6: 65, 11: 46, 12: 50, 13: 14,
                  20: 22, 17: 13, 14: 20, 22: 8, 21: 5, 19: 16, 15: 19, 18: 19, 16: 19, 29: 5, 28: 8, 24: 4, 23: 3,
                  25: 5, 30: 6, 27: 3, 26: 6}
distr_numdays_3 = {0: 203, 1: 91, 2: 86, 3: 62, 4: 85, 5: 54, 7: 37, 6: 59, 8: 52, 9: 58, 11: 43, 10: 48, 17: 16, 12: 45,
                  20: 18, 16: 14, 13: 8, 19: 14, 22: 6, 28: 5, 15: 21, 29: 4, 30: 6, 25: 6, 23: 4, 21: 8, 18: 16,
                  14: 24, 27: 4, 24: 4, 26: 7}
distr_numdays_4 = {0: 194, 2: 89, 1: 103, 4: 74, 3: 58, 6: 45, 5: 60, 8: 33, 7: 30, 10: 56, 11: 54, 14: 21, 9: 45,
                  12: 56, 19: 23, 23: 5, 15: 17, 16: 20, 17: 14, 27: 7, 18: 20, 13: 15, 24: 11, 25: 3, 30: 4, 29: 2,
                  22: 9, 21: 5, 26: 5, 28: 6, 20: 17}
distr_numdays_5 = {0: 208, 1: 109, 3: 60, 5: 51, 4: 66, 2: 90, 6: 50, 8: 53, 10: 47, 9: 48, 11: 35, 7: 40, 12: 52, 13: 8,
                  17: 15, 20: 18, 30: 6, 24: 7, 29: 8, 14: 25, 15: 22, 16: 22, 18: 29, 19: 14, 21: 7, 27: 3, 23: 6,
                  25: 1, 26: 6, 22: 2, 28: 4}
distr_numdays_6 = {0: 209, 1: 99, 2: 87, 3: 66, 4: 49, 6: 44, 8: 38, 5: 50, 7: 47, 13: 11, 9: 49, 16: 23, 12: 63, 19: 13,
                  18: 22, 11: 44, 15: 21, 23: 11, 20: 21, 30: 4, 17: 30, 10: 43, 14: 22, 22: 3, 28: 6, 24: 3, 25: 6,
                  26: 2, 21: 8, 27: 9, 29: 7}
distr_numdays_7 = {0: 200, 1: 87, 2: 81, 4: 70, 3: 66, 5: 45, 7: 48, 8: 47, 9: 52, 11: 49, 6: 53, 12: 55, 13: 21, 16: 25,
                  17: 17, 15: 26, 10: 52, 20: 26, 27: 5, 29: 8, 30: 3, 23: 8, 14: 19, 19: 13, 26: 9, 18: 10, 28: 6,
                  25: 4, 22: 4, 24: 4, 21: 4}
list_distr_numdays = [distr_numdays_1, distr_numdays_2, distr_numdays_3, distr_numdays_4,
                      distr_numdays_5, distr_numdays_6, distr_numdays_7]

# общее количество  дней, за которые осуществлялась продажа
distr_numdays = defaultdict(int)
for i in list_distr_numdays:
    for j in i.keys():
        distr_numdays[j] += i[j]
for k in range(31):
    distr_numdays[k] /= len(list_distr_numdays)

# распределение по дням (среднее число продаж в день)
distr = dict()
for i in range(31):
    distr[i] = distr_settled[i] / distr_numdays[i]


data_1 = {0: {500.0: 6, 700.0: 4, 800.0: 73, 1000.0: 42, 900.0: 103, 1100.0: 11},
          1: {500.0: 3, 700.0: 2, 800.0: 31, 900.0: 62, 1000.0: 16, 1100.0: 7},
          2: {700.0: 7, 800.0: 39, 900.0: 69, 1100.0: 6, 1000.0: 16},
          4: {800.0: 1, 1000.0: 37, 1100.0: 38, 1300.0: 1, 900.0: 3},
          6: {800.0: 2, 1000.0: 28, 1100.0: 37, 1200.0: 20, 1300.0: 2, 900.0: 1},
          5: {1000.0: 11, 1100.0: 32, 1200.0: 22, 900.0: 4},
          7: {950.0: 9, 1300.0: 14, 1200.0: 10, 1150.0: 17, 1050.0: 15, 1400.0: 1},
          9: {1000.0: 18, 1200.0: 29, 1100.0: 28, 1300.0: 4}, 11: {1000.0: 23, 1100.0: 33, 1200.0: 18, 1300.0: 1},
          13: {1200.0: 17, 1300.0: 8, 1400.0: 1}, 10: {1100.0: 39, 1200.0: 21, 1000.0: 17, 1300.0: 2},
          8: {1150.0: 16, 1050.0: 32, 1200.0: 5, 1300.0: 4, 950.0: 8}, 15: {1200.0: 5, 1300.0: 5, 1400.0: 1},
          17: {1200.0: 23, 1300.0: 3, 1400.0: 1}, 3: {1100.0: 40, 1000.0: 35, 1300.0: 2, 900.0: 2},
          20: {1200.0: 19, 1300.0: 1}, 12: {1100.0: 16, 1000.0: 35, 1300.0: 1, 1200.0: 7}, 24: {1300.0: 7},
          19: {1200.0: 18, 1300.0: 1}, 28: {1300.0: 8, 1400.0: 2}, 18: {1200.0: 33, 1300.0: 4}, 27: {1300.0: 19},
          26: {1300.0: 4, 1400.0: 1}, 29: {1300.0: 11}, 16: {1200.0: 13, 1300.0: 3}, 30: {1300.0: 7, 1400.0: 4},
          14: {1300.0: 5, 1200.0: 17, 1400.0: 2}, 25: {1300.0: 14}, 21: {1300.0: 2, 1400.0: 7}, 23: {1300.0: 4},
          22: {1300.0: 4}}
data_2 = {0: {500.0: 6, 800.0: 79, 1000.0: 37, 1100.0: 20, 900.0: 101, 700.0: 6},
          1: {700.0: 2, 800.0: 21, 900.0: 53, 1000.0: 24, 1100.0: 7},
          2: {500.0: 2, 700.0: 5, 800.0: 28, 1100.0: 5, 900.0: 57, 1000.0: 21},
          3: {700.0: 1, 1100.0: 40, 1000.0: 27, 900.0: 2}, 4: {900.0: 10, 1000.0: 47, 1100.0: 31, 1300.0: 1},
          5: {800.0: 2, 900.0: 1, 1000.0: 12, 1100.0: 33, 1200.0: 25, 1300.0: 3},
          6: {900.0: 2, 1100.0: 35, 1200.0: 24, 1000.0: 13},
          8: {950.0: 13, 1050.0: 27, 1200.0: 9, 1150.0: 16, 1300.0: 4},
          11: {1000.0: 22, 1200.0: 19, 1100.0: 22, 1300.0: 2},
          7: {1150.0: 14, 1200.0: 4, 1300.0: 6, 950.0: 5, 1050.0: 12, 1400.0: 1},
          12: {1000.0: 42, 1100.0: 36, 1200.0: 8},
          9: {1100.0: 26, 1000.0: 11, 1300.0: 6, 1200.0: 26}, 13: {1200.0: 10, 1300.0: 9, 1400.0: 1},
          18: {1200.0: 31, 1300.0: 5}, 24: {1300.0: 5}, 16: {1200.0: 13, 1300.0: 4},
          10: {1300.0: 4, 1200.0: 14, 1000.0: 14, 1100.0: 29}, 26: {1300.0: 6, 1400.0: 2}, 15: {1200.0: 19, 1300.0: 7},
          23: {1300.0: 6, 1400.0: 3}, 27: {1400.0: 1, 1300.0: 11}, 17: {1200.0: 13, 1300.0: 2},
          21: {1300.0: 6, 1400.0: 2, 1500.0: 2}, 29: {1300.0: 5}, 19: {1200.0: 17, 1300.0: 7},
          14: {1200.0: 23, 1300.0: 5},
          28: {1300.0: 10}, 30: {1300.0: 3}, 25: {1300.0: 14}, 20: {1200.0: 29, 1300.0: 2}, 22: {1300.0: 4, 1400.0: 2}}
data_3 = {0: {500.0: 6, 700.0: 5, 900.0: 111, 1000.0: 38, 1100.0: 18, 800.0: 43},
          1: {500.0: 2, 700.0: 1, 800.0: 25, 900.0: 61, 1000.0: 24, 1100.0: 8},
          2: {800.0: 25, 1100.0: 9, 900.0: 42, 700.0: 1, 1000.0: 16},
          3: {800.0: 3, 1100.0: 45, 1000.0: 29, 1300.0: 3, 900.0: 6}, 4: {900.0: 8, 1100.0: 45, 1000.0: 40, 1300.0: 1},
          6: {800.0: 1, 900.0: 1, 1100.0: 52, 1200.0: 17, 1000.0: 13},
          7: {900.0: 2, 950.0: 2, 1050.0: 16, 1300.0: 6, 1150.0: 17, 1200.0: 11, 1400.0: 1},
          8: {950.0: 3, 1150.0: 23, 1200.0: 10, 1300.0: 8, 1050.0: 36, 1400.0: 1},
          5: {1200.0: 26, 1000.0: 5, 1100.0: 28, 1300.0: 2, 900.0: 2},
          9: {1000.0: 9, 1100.0: 28, 1200.0: 33, 1300.0: 3},
          11: {1000.0: 31, 1100.0: 26, 1200.0: 15}, 10: {1000.0: 16, 1100.0: 44, 1200.0: 13, 1300.0: 5},
          13: {1200.0: 24, 1300.0: 4}, 18: {1200.0: 20, 1300.0: 3}, 20: {1200.0: 37, 1300.0: 1},
          12: {1000.0: 34, 1100.0: 35, 1200.0: 8}, 15: {1200.0: 27, 1300.0: 2}, 16: {1200.0: 24, 1300.0: 3, 1400.0: 1},
          19: {1200.0: 23, 1400.0: 1}, 27: {1300.0: 7}, 24: {1300.0: 6}, 14: {1200.0: 18, 1300.0: 4}, 17: {1200.0: 13},
          28: {1300.0: 3}, 30: {1300.0: 8, 1400.0: 2}, 29: {1300.0: 7}, 26: {1300.0: 7, 1400.0: 2},
          21: {1300.0: 5, 1400.0: 1}, 25: {1300.0: 9}, 23: {1300.0: 2}, 22: {1300.0: 1}}
data_4 = {0: {500.0: 7, 800.0: 87, 1000.0: 47, 900.0: 140, 1100.0: 16, 700.0: 2},
          1: {500.0: 1, 700.0: 2, 900.0: 56, 1100.0: 14, 1000.0: 15, 800.0: 37},
          2: {500.0: 1, 700.0: 5, 800.0: 33, 1100.0: 5, 900.0: 29, 1000.0: 15},
          3: {1000.0: 30, 1100.0: 42, 900.0: 2, 1300.0: 3}, 4: {900.0: 7, 1100.0: 42, 1000.0: 30, 1300.0: 2},
          7: {900.0: 3, 1200.0: 7, 1050.0: 19, 1150.0: 13, 1300.0: 9, 1400.0: 1},
          6: {900.0: 2, 1000.0: 15, 1100.0: 48, 1200.0: 19, 1300.0: 2},
          8: {900.0: 2, 1200.0: 6, 1050.0: 22, 1150.0: 17, 950.0: 9, 1300.0: 3},
          9: {1000.0: 9, 1100.0: 28, 1200.0: 23, 1300.0: 1}, 12: {1000.0: 22, 1100.0: 32, 1200.0: 18, 1300.0: 3},
          5: {1200.0: 21, 1100.0: 22, 1000.0: 9}, 14: {1200.0: 24, 1300.0: 10}, 15: {1200.0: 21, 1300.0: 4},
          18: {1200.0: 20, 1300.0: 3}, 11: {1100.0: 30, 1200.0: 10, 1000.0: 12, 1300.0: 2},
          10: {1300.0: 2, 1100.0: 25, 1000.0: 12, 1200.0: 18, 1400.0: 1}, 16: {1200.0: 21, 1300.0: 2}, 20: {1200.0: 30},
          19: {1200.0: 24}, 13: {1200.0: 18, 1400.0: 3, 1300.0: 5}, 29: {1300.0: 8}, 26: {1300.0: 7},
          23: {1300.0: 6, 1400.0: 4}, 21: {1300.0: 10, 1500.0: 1}, 17: {1200.0: 20, 1300.0: 3, 1400.0: 2},
          22: {1300.0: 5, 1400.0: 1}, 30: {1300.0: 6}, 24: {1300.0: 8, 1400.0: 4}, 28: {1300.0: 12},
          25: {1400.0: 2, 1300.0: 8}, 27: {1300.0: 4, 1400.0: 2}}
data_5 = {0: {500.0: 5, 900.0: 104, 1000.0: 49, 800.0: 42, 1100.0: 11, 700.0: 1},
          1: {500.0: 5, 900.0: 57, 800.0: 36, 1000.0: 22, 1100.0: 6, 700.0: 1},
          2: {700.0: 2, 900.0: 54, 1000.0: 13, 800.0: 27, 1100.0: 10},
          4: {700.0: 2, 1100.0: 47, 1000.0: 29, 1300.0: 1, 900.0: 9}, 3: {1100.0: 31, 1000.0: 41, 1300.0: 2, 900.0: 3},
          5: {900.0: 1, 1100.0: 45, 1200.0: 31, 1000.0: 10, 1300.0: 3},
          6: {900.0: 3, 1100.0: 29, 1200.0: 22, 1000.0: 21, 1300.0: 1},
          7: {950.0: 3, 1150.0: 22, 1050.0: 12, 1300.0: 6, 1200.0: 15},
          10: {1000.0: 17, 1200.0: 16, 1100.0: 34, 1300.0: 6},
          13: {1200.0: 10, 1300.0: 2}, 9: {1000.0: 13, 1100.0: 34, 1200.0: 21, 1300.0: 5},
          8: {1050.0: 32, 1150.0: 21, 1200.0: 8, 950.0: 3, 1300.0: 7},
          11: {1000.0: 26, 1100.0: 38, 1200.0: 9, 1300.0: 1},
          12: {1000.0: 40, 1100.0: 22, 1200.0: 9}, 17: {1200.0: 22, 1300.0: 2}, 22: {1300.0: 5, 1400.0: 1},
          15: {1200.0: 23, 1300.0: 8}, 16: {1200.0: 17, 1300.0: 4}, 30: {1300.0: 12}, 20: {1200.0: 25},
          14: {1200.0: 17},
          27: {1300.0: 9}, 25: {1300.0: 8, 1400.0: 1}, 24: {1300.0: 12}, 26: {1300.0: 6, 1400.0: 3}, 29: {1300.0: 13},
          18: {1200.0: 27, 1300.0: 3}, 21: {1400.0: 2, 1300.0: 8}, 19: {1200.0: 21, 1300.0: 3}, 28: {1300.0: 4},
          23: {1300.0: 9}}
data_6 = {0: {500.0: 6, 700.0: 6, 800.0: 43, 1000.0: 51, 900.0: 114, 1100.0: 19},
          1: {500.0: 1, 700.0: 3, 1100.0: 9, 1000.0: 22, 900.0: 51, 800.0: 11},
          2: {700.0: 7, 900.0: 46, 1000.0: 20, 800.0: 26, 1100.0: 11}, 5: {1000.0: 6, 1100.0: 30, 1200.0: 23},
          7: {900.0: 2, 950.0: 5, 1050.0: 12, 1150.0: 30, 1300.0: 9, 1200.0: 8},
          6: {1100.0: 47, 1200.0: 33, 1000.0: 9, 900.0: 1}, 3: {1100.0: 36, 1000.0: 27, 1300.0: 1, 900.0: 1},
          9: {1100.0: 15, 1000.0: 13, 1200.0: 25, 1300.0: 1, 1400.0: 1},
          4: {1100.0: 44, 1000.0: 38, 1300.0: 1, 800.0: 1, 900.0: 4},
          11: {1000.0: 24, 1100.0: 43, 1200.0: 17, 1300.0: 1},
          12: {1100.0: 34, 1000.0: 30, 1200.0: 11},
          8: {1150.0: 23, 1050.0: 17, 1200.0: 10, 1300.0: 3, 900.0: 2, 950.0: 7},
          15: {1200.0: 24, 1300.0: 5}, 16: {1200.0: 36, 1300.0: 6}, 10: {1000.0: 16, 1100.0: 24, 1200.0: 19, 1300.0: 3},
          21: {1300.0: 6, 1400.0: 3}, 13: {1200.0: 11, 1400.0: 1, 1300.0: 6}, 17: {1200.0: 20, 1300.0: 3},
          18: {1200.0: 30, 1300.0: 5}, 14: {1200.0: 8, 1300.0: 5, 1400.0: 1}, 26: {1300.0: 8, 1400.0: 1},
          24: {1300.0: 10},
          19: {1200.0: 25}, 22: {1300.0: 10}, 20: {1200.0: 37}, 28: {1300.0: 6}, 23: {1400.0: 4, 1300.0: 11},
          30: {1300.0: 2}, 29: {1300.0: 9, 1400: 1}, 27: {1300.0: 13}, 25: {1300.0: 8}}
data_7 = {0: {500.0: 7, 900.0: 113, 1000.0: 39, 800.0: 61, 1100.0: 19, 700.0: 4},
          1: {500.0: 3, 700.0: 7, 800.0: 22, 900.0: 48, 1000.0: 23, 1100.0: 5},
          2: {500.0: 3, 800.0: 42, 900.0: 46, 1000.0: 22, 1100.0: 8, 700.0: 1},
          4: {800.0: 1, 900.0: 14, 1100.0: 40, 1000.0: 30, 1300.0: 2},
          3: {800.0: 1, 900.0: 1, 1100.0: 38, 1000.0: 28, 1300.0: 2},
          5: {900.0: 3, 1100.0: 31, 1200.0: 23, 1300.0: 3, 1000.0: 8},
          7: {900.0: 2, 1150.0: 28, 1050.0: 20, 1300.0: 9, 1200.0: 6, 950.0: 2},
          8: {950.0: 5, 1300.0: 6, 1050.0: 23, 1400.0: 1, 1200.0: 6, 1150.0: 17},
          10: {1000.0: 12, 1100.0: 26, 1200.0: 17, 1300.0: 3}, 9: {1200.0: 15, 1000.0: 14, 1100.0: 42, 1300.0: 6},
          6: {1100.0: 43, 1000.0: 10, 1200.0: 26, 900.0: 3, 1300.0: 1},
          11: {1000.0: 18, 1100.0: 28, 1300.0: 4, 1200.0: 15},
          12: {1000.0: 38, 1100.0: 41, 1200.0: 2}, 13: {1200.0: 15, 1300.0: 2, 1400.0: 2}, 20: {1200.0: 24, 1300.0: 1},
          17: {1200.0: 14, 1300.0: 3}, 14: {1200.0: 23, 1300.0: 10}, 22: {1400.0: 2, 1300.0: 9}, 21: {1300.0: 9},
          19: {1200.0: 26, 1300.0: 2}, 15: {1300.0: 8, 1200.0: 23}, 18: {1200.0: 25, 1300.0: 3},
          16: {1200.0: 21, 1300.0: 3}, 29: {1300.0: 5, 1400.0: 1}, 28: {1300.0: 11, 1400.0: 1}, 24: {1300.0: 5},
          23: {1300.0: 3, 1400.0: 1}, 25: {1300.0: 5}, 30: {1300.0: 7, 1400.0: 2}, 27: {1300.0: 3}, 26: {1300.0: 8}}
data_8 = {0: {500.0: 7, 700.0: 5, 800.0: 61, 900.0: 98, 1000.0: 38, 1100.0: 22},
          1: {500.0: 2, 800.0: 35, 900.0: 40, 1000.0: 25, 1100.0: 4, 700.0: 2},
          2: {500.0: 4, 900.0: 43, 800.0: 22, 1000.0: 14, 1100.0: 9, 700.0: 3},
          3: {800.0: 1, 900.0: 1, 1000.0: 29, 1100.0: 48, 1300.0: 1}, 4: {700.0: 1, 900.0: 13, 1100.0: 51, 1000.0: 50},
          5: {1000.0: 7, 1200.0: 26, 1100.0: 33, 900.0: 1, 1300.0: 1},
          7: {900.0: 2, 950.0: 5, 1050.0: 18, 1150.0: 20, 1300.0: 5, 1200.0: 9},
          6: {900.0: 3, 1000.0: 15, 1200.0: 16, 1100.0: 43, 1300.0: 1},
          8: {900.0: 1, 1300.0: 8, 1050.0: 36, 1200.0: 4, 1150.0: 20, 950.0: 5},
          9: {1000.0: 15, 1300.0: 1, 1100.0: 36, 1200.0: 27}, 11: {1000.0: 24, 1100.0: 32, 1200.0: 7, 1300.0: 3},
          10: {1100.0: 36, 1000.0: 10, 1200.0: 20, 1300.0: 3}, 17: {1200.0: 18, 1300.0: 2},
          12: {1000.0: 43, 1100.0: 23, 1300.0: 4, 1200.0: 3}, 20: {1200.0: 27, 1300.0: 2}, 16: {1200.0: 21},
          13: {1200.0: 10, 1300.0: 1}, 19: {1200.0: 22}, 22: {1300.0: 5, 1400.0: 3}, 28: {1300.0: 7},
          15: {1200.0: 21, 1300.0: 6, 1400.0: 2}, 29: {1300.0: 5, 1400.0: 1}, 30: {1300.0: 10}, 25: {1300.0: 7},
          23: {1300.0: 3, 1400.0: 1}, 21: {1400.0: 3, 1300.0: 7, 1500.0: 1}, 18: {1200.0: 29},
          14: {1300.0: 4, 1200.0: 35, 1400.0: 1}, 27: {1300.0: 7}, 24: {1300.0: 7}, 26: {1300.0: 9}}
data_9 = {0: {500.0: 9, 800.0: 49, 1100.0: 9, 900.0: 99, 1000.0: 48, 700.0: 1},
          2: {500.0: 2, 800.0: 32, 1100.0: 6, 1000.0: 22, 900.0: 56}, 1: {1100.0: 9, 800.0: 25, 900.0: 62, 1000.0: 29},
          4: {700.0: 1, 800.0: 2, 1000.0: 38, 1100.0: 46, 900.0: 8, 1300.0: 1},
          3: {1000.0: 20, 1100.0: 47, 900.0: 1, 1300.0: 1}, 6: {800.0: 1, 900.0: 2, 1100.0: 35, 1200.0: 17, 1000.0: 6},
          5: {1000.0: 12, 1100.0: 43, 1200.0: 26},
          8: {900.0: 3, 1150.0: 12, 1200.0: 3, 1050.0: 14, 1300.0: 7, 950.0: 3},
          7: {1050.0: 18, 950.0: 3, 1300.0: 12, 1200.0: 3, 1150.0: 13},
          10: {1000.0: 10, 1100.0: 36, 1200.0: 31, 1300.0: 5},
          11: {1000.0: 19, 1100.0: 42, 1200.0: 15}, 14: {1200.0: 20, 1300.0: 11},
          9: {1100.0: 18, 1200.0: 34, 1300.0: 3, 1000.0: 7, 1400.0: 1}, 12: {1000.0: 37, 1100.0: 44, 1200.0: 8},
          19: {1200.0: 31, 1300.0: 4}, 23: {1300.0: 8}, 15: {1200.0: 20, 1300.0: 2}, 16: {1200.0: 26, 1300.0: 4},
          17: {1200.0: 22, 1300.0: 1}, 27: {1300.0: 8, 1400.0: 2}, 18: {1200.0: 31, 1300.0: 1},
          13: {1200.0: 14, 1300.0: 6},
          24: {1300.0: 11, 1400.0: 1}, 25: {1300.0: 3}, 30: {1300.0: 4}, 29: {1300.0: 2}, 22: {1300.0: 13, 1400.0: 2},
          21: {1300.0: 6}, 26: {1300.0: 7, 1400.0: 1}, 28: {1300.0: 7}, 20: {1200.0: 21, 1300.0: 1}}
data_10 = {0: {500.0: 6, 700.0: 10, 800.0: 60, 900.0: 127, 1000.0: 46, 1100.0: 5},
           1: {500.0: 2, 700.0: 5, 800.0: 23, 1100.0: 11, 1000.0: 33, 900.0: 53},
           3: {900.0: 7, 1100.0: 46, 1000.0: 27, 1300.0: 1},
           5: {800.0: 1, 1000.0: 9, 1200.0: 22, 1300.0: 4, 1100.0: 23},
           4: {1000.0: 41, 1100.0: 45, 1300.0: 1, 900.0: 4}, 2: {1000.0: 11, 900.0: 52, 1100.0: 5, 800.0: 38, 700.0: 4},
           6: {1000.0: 10, 1200.0: 20, 1100.0: 40, 900.0: 2},
           8: {900.0: 4, 950.0: 9, 1050.0: 33, 1200.0: 5, 1150.0: 13, 1300.0: 13},
           10: {1000.0: 9, 1100.0: 36, 1200.0: 13, 1300.0: 3}, 9: {1000.0: 10, 1100.0: 33, 1200.0: 24, 1300.0: 7},
           11: {1000.0: 18, 1100.0: 22, 1200.0: 7},
           7: {1150.0: 24, 1300.0: 9, 1050.0: 18, 1200.0: 1, 950.0: 1, 1400.0: 1},
           12: {1000.0: 27, 1100.0: 42, 1300.0: 1, 1200.0: 3}, 13: {1200.0: 7, 1300.0: 5}, 17: {1200.0: 19, 1300.0: 4},
           20: {1200.0: 25}, 30: {1300.0: 8, 1400.0: 1}, 24: {1300.0: 13}, 29: {1300.0: 12},
           14: {1200.0: 25, 1300.0: 10},
           15: {1200.0: 15, 1300.0: 10, 1400.0: 3}, 16: {1200.0: 26, 1300.0: 4}, 18: {1200.0: 40, 1300.0: 3},
           19: {1200.0: 23}, 21: {1300.0: 10, 1400.0: 2}, 27: {1300.0: 4}, 23: {1300.0: 7}, 25: {1300.0: 2},
           26: {1300.0: 8, 1400.0: 1}, 22: {1400.0: 1, 1300.0: 3}, 28: {1300.0: 7}}
data_11 = {0: {500.0: 3, 800.0: 62, 900.0: 115, 1000.0: 46, 1100.0: 12, 700.0: 4},
           1: {500.0: 6, 700.0: 3, 900.0: 55, 800.0: 26, 1000.0: 17, 1100.0: 10},
           2: {700.0: 2, 800.0: 45, 900.0: 45, 1000.0: 14, 1100.0: 6}, 3: {1000.0: 40, 900.0: 5, 1100.0: 39, 1300.0: 1},
           4: {800.0: 2, 900.0: 6, 1000.0: 15, 1100.0: 32, 1300.0: 3},
           6: {800.0: 1, 900.0: 2, 1200.0: 21, 1000.0: 13, 1100.0: 21},
           8: {900.0: 2, 1150.0: 18, 1050.0: 21, 1300.0: 7, 950.0: 6, 1200.0: 3},
           5: {1000.0: 8, 1200.0: 18, 1100.0: 42, 1300.0: 2},
           7: {1150.0: 28, 1300.0: 11, 1050.0: 26, 1200.0: 7, 950.0: 1},
           13: {1300.0: 6, 1200.0: 7}, 9: {1300.0: 4, 1100.0: 29, 1200.0: 28, 1000.0: 12}, 16: {1200.0: 31, 1300.0: 3},
           12: {1000.0: 46, 1100.0: 26, 1200.0: 14}, 19: {1200.0: 13, 1300.0: 2}, 18: {1200.0: 31, 1300.0: 5},
           11: {1000.0: 21, 1100.0: 32, 1300.0: 2, 1200.0: 14}, 15: {1200.0: 19, 1300.0: 8},
           23: {1300.0: 11, 1400.0: 3},
           20: {1200.0: 29, 1300.0: 4}, 30: {1300.0: 6}, 17: {1200.0: 46, 1300.0: 2},
           10: {1300.0: 4, 1200.0: 19, 1000.0: 9, 1100.0: 30}, 14: {1200.0: 21, 1300.0: 8}, 22: {1300.0: 2, 1400.0: 1},
           28: {1300.0: 8}, 24: {1400.0: 1, 1300.0: 3}, 25: {1400.0: 2, 1300.0: 5}, 26: {1300.0: 3},
           21: {1300.0: 8, 1400.0: 6}, 27: {1300.0: 12, 1400.0: 1}, 29: {1400.0: 2, 1300.0: 10}}
data_12 = {0: {500.0: 6, 800.0: 50, 900.0: 107, 1000.0: 48, 1100.0: 17},
           1: {500.0: 2, 1100.0: 8, 1000.0: 20, 900.0: 48, 800.0: 24},
           2: {800.0: 23, 900.0: 41, 1000.0: 20, 1100.0: 9, 700.0: 5},
           4: {900.0: 5, 800.0: 2, 1100.0: 48, 1000.0: 34, 1300.0: 1}, 3: {900.0: 8, 1000.0: 34, 1100.0: 45, 1300.0: 2},
           5: {800.0: 1, 1100.0: 29, 1200.0: 29, 1000.0: 6, 1300.0: 1},
           7: {900.0: 2, 1050.0: 23, 1150.0: 21, 1300.0: 7, 950.0: 9, 1200.0: 7},
           8: {900.0: 3, 1050.0: 28, 1150.0: 19, 950.0: 8, 1200.0: 9, 1300.0: 7},
           9: {1000.0: 21, 1100.0: 33, 1200.0: 14, 1300.0: 4}, 11: {1000.0: 18, 1200.0: 16, 1100.0: 27, 1300.0: 1},
           6: {1100.0: 50, 1200.0: 17, 1000.0: 5, 1300.0: 2}, 12: {1000.0: 51, 1100.0: 31, 1200.0: 13},
           13: {1200.0: 21, 1300.0: 10}, 16: {1200.0: 33, 1300.0: 7}, 17: {1200.0: 28}, 15: {1200.0: 34, 1300.0: 2},
           10: {1100.0: 51, 1200.0: 20, 1000.0: 8, 1300.0: 1}, 20: {1200.0: 38}, 27: {1300.0: 8}, 29: {1300.0: 14},
           30: {1300.0: 6}, 23: {1300.0: 10, 1400.0: 2}, 14: {1200.0: 15, 1300.0: 8, 1400.0: 1}, 19: {1200.0: 19},
           26: {1300.0: 11, 1400.0: 2}, 18: {1300.0: 4, 1200.0: 11}, 28: {1300.0: 7}, 25: {1300.0: 6}, 22: {1300.0: 6},
           24: {1300.0: 6}, 21: {1300.0: 5, 1400.0: 1}}

# день->тариф: количество раз применения за все время
data = defaultdict(dict)
list_data = [data_1, data_2, data_3, data_4, data_5, data_6, data_7, data_8, data_9, data_10, data_11, data_12]

for a in list_data:
    for i in a.keys():
        for j in a[i].keys():
            if j not in data[i].keys():
                data[i][j] = a[i][j]
            else:
                data[i][j] += a[i][j]

# все применненые тарифы по дню
list_tarif_deth = [[] for i in range(31)]

# день->тариф:среднее количество раз применения за год
for i in data.keys():
    for j in data[i].keys():
        data[i][j] = (data[i][j] / len(list_data))
        for k in range(ceil(data[i][j])):
            list_tarif_deth[i].append(j)

# день->[мин. тариф в день,макс. тариф в день]
vec_minmax_tarif_deth = defaultdict(list)

# нахождение среднего тарифа и ско
for num, val in enumerate(list_tarif_deth):
    val = np.array(val)
    mean_tarif = np.mean(val)
    std_tarif = np.std(val)
    vec_minmax_tarif_deth[num] = [round(max(mean_tarif - 2 * std_tarif, min(val)), -2),
                                  round(mean_tarif + 2 * std_tarif, -2)]

# день->[[тариф,частота применения],...]
vec_frec = defaultdict(list)

# преобразование из кол-во всего купленных по данной цене --> в среднее число покупки в день (кол-во покупки/среднее число продаж в день)
for i in data.keys():
    for j in data[i].keys():
        data[i][j] = data[i][j] / (distr[i])
        vec_frec[i].append([j, data[i][j]])
    vec_frec[i].sort()

# преобразование из среднее число покупки в день --> в накопленную частоту в день
for i in vec_frec.keys():
    for j in range(len(vec_frec[i])):
        data[i][vec_frec[i][j][0]] = 0
        for k in range(j, len(vec_frec[i])):
            data[i][vec_frec[i][j][0]] += vec_frec[i][k][1]

data_sort = sorted(data.items())


def nearest_value(values, one):
    """
    :param values: список предложенных значений
    :param one: поиск положения данного параметра
    :return:  ближайшее значение к параметру one
    """
    return min(values, key=lambda n: (abs(one - n), n))


# день:[минимальная цена,кол-во продаж]
vec_min = defaultdict(list)
# день:[maxимальная цена,кол-во продаж]
vec_max = defaultdict(list)

# расчет максимальной и минимальной цены
for num, val in enumerate(data_sort):
    vec_min[num] = [nearest_value(val[1].keys(), vec_minmax_tarif_deth[num][0])]
    vec_min[num].append(val[1][vec_min[num][0]])
    vec_max[num] = [nearest_value(val[1].keys(), vec_minmax_tarif_deth[num][1])]
    if vec_min[num][0] == vec_max[num][0]: vec_max[num] = [max(val[1].keys())]
    vec_max[num].append(val[1][vec_max[num][0]])

# день:[k,b]
vec_koef_segm = defaultdict(list)
for i in range(31):
    if (vec_min[i][0] == vec_max[i][0]):
        vec_koef_segm[i] = [0]
    else:
        vec_koef_segm[i] = [(vec_min[i][1] - vec_max[i][1]) / (vec_min[i][0] - vec_max[i][0])]
    vec_koef_segm[i].append((vec_max[i][1] - vec_koef_segm[i][0] * vec_max[i][0]))


def round50(n):  # округление до 50
    return round(n * 2, -2) // 2


# оптимальный доход=-b/2к
opt_cost = defaultdict()
for i in range(31):
    opt_cost[i] = round50(int(-vec_koef_segm[i][1] / (2 * vec_koef_segm[i][0])))

# (глубина,загрузка(сколько осталось)):тариф
strateg = {(i, j): 0 for i in reversed(range(31)) for j in range(1, 16)}

# вычислим оптимальный тариф, и все что ниже загрузки продается по этому тарифу
for i in range(31):
    for j in range(1, 16):
        if j >= round(vec_koef_segm[i][1] / 2):
            strateg[(i, j)] = opt_cost[i]
        else:
            strateg[(i, j)] = round50(((j - vec_koef_segm[i][1]) / vec_koef_segm[i][0]) - 50)
# print(strateg)
